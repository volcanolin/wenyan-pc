# Changelog

## [2.4.11] - 2025-10-15 (文颜-rev 版本)

### 🆕 新增
- **项目重命名**: 文颜 → 文颜-rev
- **独立应用标识符**: 修改为 `com.github.volcanolin.wenyan-rev`，支持与原版文颜同时安装
- **版权信息更新**: 增加原作者和增强版作者署名

### 📝 说明
**文颜-rev** 是基于原版文颜的增强版本，专注于用户体验优化和功能扩展。用户可以同时安装原版和文颜-rev，两个版本完全独立运行。

### 🔧 技术变更
- 更新所有配置文件中的应用标识符
- 更新项目文档和版权声明

---

## [2.4.10] - 2025-10-07

### 修复
- 修复脚注功能重复添加导致序号叠加显示的问题
- 修复左侧编辑区修改内容后脚注功能失效的问题
- 解决脚注状态在内容更新时丢失的根本原因

### 改进
- 新增脚注状态持久化管理，使用 localStorage 存储脚注启用状态
- 优化脚注状态恢复机制，确保内容更新后自动恢复脚注功能
- 增强脚注功能的防重复调用机制，避免序号重复显示

### 技术优化
- 重构脚注状态管理，从 DOM 检测改为持久化状态读取
- 统一脚注状态恢复逻辑，涵盖所有内容更新路径
- 提升脚注功能的可靠性和用户体验一致性

## [2.4.9] - 2025-10-04

### 修复
- 修复脚注功能与图例功能的交互冲突问题
- 解决切换图例开关时脚注功能失效的问题
- 修复CSS伪元素在复制到微信公众号时的格式问题

### 改进
- 优化伪元素处理机制，将`<section>`元素改为`<span>`避免不必要的换行
- 增强三角形装饰等CSS伪元素的跨平台兼容性
- 改进`refreshContentWithFont()`函数，在内容重新渲染后自动恢复脚注状态

### 技术优化
- 统一脚注和图例功能的状态管理机制
- 增强DOM重建时的状态保持能力
- 优化用户交互体验，避免功能间的相互干扰

## [2.4.8] - 2025-10-03

### 修复
- 修复脚注功能开启时超链接显示双重下划线的问题
- 修复脚注功能在微信公众号预览时下划线消失的问题
- 修复主题切换后脚注链接颜色残留上一主题颜色的问题

### 改进
- 重构脚注功能的样式实现，从JavaScript硬编码样式改为CSS类控制
- 优化脚注链接的样式管理，确保与各主题的设计风格一致
- 增强主题切换时的样式重置机制，自动应用新主题的脚注样式
- 改进微信公众号的脚注链接兼容性，使用span包装确保下划线正常显示
- 统一脚注链接的颜色获取机制，与预览区显示效果保持一致

### 技术优化
- 简化脚注功能的JavaScript实现，提高代码可维护性
- 优化脚注样式的应用策略，避免样式冲突和重复问题
- 增强自定义主题对脚注功能的支持

## [2.4.7] - 2025-10-02

### 新增
- 新增脚注功能状态持久化，软件重启后能记住脚注功能的开启/关闭状态
- 完善脚注按钮的即时反馈机制，确保按钮颜色与功能状态实时同步
- 改进脚注功能的状态管理，提升用户体验的一致性

### 修复
- 修复图例功能重启后状态恢复问题，确保软件重启后图例功能状态正确恢复
- 修复脚注功能在使用过程中按钮状态不更新的问题
- 修复图例和脚注功能的状态初始化时机问题，确保内容正确渲染

### 改进
- 重构图例和脚注功能的状态同步机制，采用直接状态读取替代DOM检测
- 优化应用启动时的状态初始化流程，确保所有功能状态正确加载
- 增强调试日志，便于状态问题的排查和解决
- 统一图例和脚注功能的实现模式，提高代码可维护性

## [2.4.6] - 2025-09-19

### 修复
- 修复图例功能开启/关闭时字体重置问题
- 修复脚注功能多次点击导致字体重置问题
- 修复字体设置持久化问题，确保软件重启后字体设置正确应用
- 修复图例和脚注按钮初始状态与功能状态不一致的问题

### 改进
- 优化图例功能的实现机制，避免内容重新渲染导致的字体重置
- 优化脚注功能的实现机制，统一使用消息传递处理状态变化
- 为脚注按钮添加视觉状态反馈，开启时显示蓝色，关闭时显示透明
- 增强字体设置的可靠性，在内容加载完成后自动重新应用已保存的字体设置
- 完善状态同步机制，确保按钮颜色与实际功能状态保持一致

## [2.4.5] - 2025-09-05

### 改进
- 增加自定义主题数量限制，从最多3个扩展到10个
- 优化"创建新主题"按钮的加号图标垂直居中显示
- 新增图例功能，增强用户体验

## [2.4.4] - 2025-02-28

### 修复
- 修复脚注样式显示问题
- 修复主题选择器在某些情况下的显示异常

## [2.4.3] - 2025-02-18

### 改进
- 借鉴[墨滴](https://mdnice.com/)的字体设置，优化字体设置为衬线时的显示效果
  - 不同的操作系统支持的字体不同，没有字体可以在所有系统都生效，
  - 衬线字体只在安卓设备上生效
  - Windows 系统下，字体设置为"微软雅黑"，iOS 系统下，字体设置为 Optima
- 在"关于"窗口中添加了我的联系方式
- 优化"关于"窗口的显示效果，调整窗口尺寸

## [2.4.2] - 2025-02-14

### 新增
- 新增字体选择功能
  - 支持在"跟随主题"、"衬线"和"无衬线"字体之间切换
  - 字体设置会被保存并在重启后保持
  - 字体选择按钮位于主题和预览按钮之间
- 新增自定义主题重命名功能，双击自定义主题名称可重命名

### 修复
- 优化了字体切换时的用户体验
- 确保字体设置不影响其他功能（如复制功能）的正常使用
- 修复任务列表复选框后文本异常换行问题
- 修复微信公众号保存时复选框丢失的问题，用☐、☑代替复选框

### 改进
- 优化自定义主题及代码高亮主题的排列顺序 

## [2.4.1] - 2025-01-29

### 新增
- 支持多种代码高亮主题（GitHub、Visual Studio、Atom Dark/Light、Monokai）
- 代码块使用 JetBrains Mono 字体
- 代码块样式优化，支持深色/浅色主题

### 修复
- 修复列表项中行内代码和加粗文本的换行问题
- 修复代码块缩进显示问题

### 改进
- 优化代码块在微信公众号中的显示效果
- 改进字体渲染